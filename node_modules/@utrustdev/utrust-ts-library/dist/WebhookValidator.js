"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
var hmac_sha256_1 = __importDefault(require("crypto-js/hmac-sha256"));
var enc_hex_1 = __importDefault(require("crypto-js/enc-hex"));
var WebhookValidator = function (webhookSecret) {
    var validateSignature = function (_a) {
        var event_type = _a.event_type, _b = _a.resource, amount = _b.amount, currency = _b.currency, reference = _b.reference, state = _a.state, eventSignature = _a.signature;
        var joinedPayload = [
            "event_type" + event_type,
            "resourceamount" + amount,
            "resourcecurrency" + currency,
            "resourcereference" + reference,
            "state" + state,
        ].join('');
        var signedPayload = hmac_sha256_1.default(joinedPayload, webhookSecret);
        var signature = enc_hex_1.default.stringify(signedPayload);
        return signature === eventSignature;
    };
    return { validateSignature: validateSignature };
};
exports.default = WebhookValidator;
//# sourceMappingURL=WebhookValidator.js.map